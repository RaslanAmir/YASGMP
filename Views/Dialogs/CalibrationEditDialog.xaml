<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="YasGMP.Views.Dialogs.CalibrationEditDialog"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:viewmodels="clr-namespace:YasGMP.ViewModels"
    xmlns:models="clr-namespace:YasGMP.Models"
    Title="Uredi kalibraciju"
    BackgroundColor="#f5f7fa"
    Padding="24">

    <ScrollView>
        <VerticalStackLayout Spacing="16">

            <Label Text="🔧 Komponenta:" FontAttributes="Bold" />
            <Picker
                ItemsSource="{Binding Components}"
                ItemDisplayBinding="{Binding Name}"
                SelectedItem="{Binding SelectedComponent, Mode=TwoWay}" />

            <Label Text="🏢 Serviser/Lab:" FontAttributes="Bold" />
            <Picker
                ItemsSource="{Binding Suppliers}"
                ItemDisplayBinding="{Binding Name}"
                SelectedItem="{Binding SelectedSupplier, Mode=TwoWay}" />

            <Label Text="📅 Datum kalibracije:" FontAttributes="Bold" />
            <DatePicker Date="{Binding Calibration.CalibrationDate, Mode=TwoWay}" />

            <Label Text="📆 Rok ponovne kalibracije:" FontAttributes="Bold" />
            <DatePicker Date="{Binding Calibration.NextDue, Mode=TwoWay}" />

            <Label Text="📊 Rezultat:" FontAttributes="Bold" />
            <Picker SelectedItem="{Binding Calibration.Result, Mode=TwoWay}">
                <Picker.ItemsSource>
                    <x:Array Type="{x:Type x:String}">
                        <x:String>prolaz</x:String>
                        <x:String>pao</x:String>
                        <x:String>uvjetno</x:String>
                        <x:String>napomena</x:String>
                    </x:Array>
                </Picker.ItemsSource>
            </Picker>

            <Label Text="📄 Certifikat (PDF):" FontAttributes="Bold" />
            <!-- Entry + quick actions (choose/open). Commands are optional if VM exposes them. -->
            <HorizontalStackLayout Spacing="8">
                <Entry
                    Text="{Binding Calibration.CertDoc, Mode=TwoWay}"
                    Placeholder="/putanja/do/certifikata.pdf"
                    HorizontalOptions="FillAndExpand" />
                <Button Text="📎 Odaberi"
                        Command="{Binding AddCertificateCommand}" />
                <Button Text="🔗 Otvori"
                        Command="{Binding OpenCertificateCommand}" />
            </HorizontalStackLayout>

            <Label Text="📝 Napomena:" FontAttributes="Bold" />
            <Editor Text="{Binding Calibration.Comment, Mode=TwoWay}" HeightRequest="80" />

            <Label Text="✍️ Digitalni potpis:" FontAttributes="Bold" />
            <!-- Readonly signature + quick action (sign) -->
            <HorizontalStackLayout Spacing="8">
                <Entry Text="{Binding Calibration.DigitalSignature}"
                       IsReadOnly="True"
                       TextColor="Gray"
                       HorizontalOptions="FillAndExpand" />
                <Button Text="✍️ Potpiši"
                        Command="{Binding SignCommand}" />
            </HorizontalStackLayout>

            <HorizontalStackLayout Spacing="14" Margin="0,10,0,0">
                <Button Text="💾 Spremi"
                        Command="{Binding SaveCommand}"
                        BackgroundColor="#c8e6c9"
                        TextColor="#2e7d32" />
                <Button Text="❌ Odustani"
                        Command="{Binding CancelCommand}"
                        BackgroundColor="#ffcdd2"
                        TextColor="#c62828" />
            </HorizontalStackLayout>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
