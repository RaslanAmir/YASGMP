<Window x:Class="YasGMP.Wpf.Dialogs.UserEditDialogWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="{DynamicResource Dialog.UserEdit.Title}"
        SizeToContent="WidthAndHeight"
        WindowStartupLocation="CenterOwner"
        MinWidth="520"
        MinHeight="640"
        ResizeMode="CanResizeWithGrip">
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/YasGMP.Wpf;component/Resources/UserEditorResources.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>
    <ScrollViewer VerticalScrollBarVisibility="Auto"
                  HorizontalScrollBarVisibility="Disabled">
        <Border Padding="24">
            <StackPanel Orientation="Vertical" Margin="0">
                <TextBlock Text="{DynamicResource Dialog.UserEdit.Title}"
                           FontSize="20"
                           FontWeight="SemiBold"
                           Margin="0,0,0,16" />

                <Grid ColumnDefinitions="Auto,*"
                      RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto"
                      RowSpacing="12"
                      ColumnSpacing="16">
                    <TextBlock Text="{DynamicResource Module.Security.Text.Username}"
                               VerticalAlignment="Center" />
                    <TextBox Grid.Column="1"
                             Text="{Binding Editor.Username, UpdateSourceTrigger=PropertyChanged}"
                             ToolTipService.ToolTip="{DynamicResource Module.Security.Text.Username}" />

                    <TextBlock Grid.Row="1"
                               Text="{DynamicResource Module.Security.Text.FullName}"
                               VerticalAlignment="Center" />
                    <TextBox Grid.Row="1"
                             Grid.Column="1"
                             Text="{Binding Editor.FullName, UpdateSourceTrigger=PropertyChanged}"
                             ToolTipService.ToolTip="{DynamicResource Module.Security.Text.FullName}" />

                    <TextBlock Grid.Row="2"
                               Text="{DynamicResource Module.Security.Text.Email}"
                               VerticalAlignment="Center" />
                    <TextBox Grid.Row="2"
                             Grid.Column="1"
                             Text="{Binding Editor.Email, UpdateSourceTrigger=PropertyChanged}"
                             ToolTipService.ToolTip="{DynamicResource Module.Security.Text.Email}" />

                    <TextBlock Grid.Row="3"
                               Text="{DynamicResource Module.Security.Text.Phone}"
                               VerticalAlignment="Center" />
                    <TextBox Grid.Row="3"
                             Grid.Column="1"
                             Text="{Binding Editor.Phone, UpdateSourceTrigger=PropertyChanged}"
                             ToolTipService.ToolTip="{DynamicResource Module.Security.Text.Phone}" />

                    <TextBlock Grid.Row="4"
                               Text="{DynamicResource Module.Security.Text.PrimaryRole}"
                               VerticalAlignment="Center" />
                    <TextBox Grid.Row="4"
                             Grid.Column="1"
                             Text="{Binding Editor.Role, UpdateSourceTrigger=PropertyChanged}"
                             ToolTipService.ToolTip="{DynamicResource Module.Security.Text.PrimaryRole}" />

                    <TextBlock Grid.Row="5"
                               Text="{DynamicResource Module.Security.Text.Department}"
                               VerticalAlignment="Center" />
                    <TextBox Grid.Row="5"
                             Grid.Column="1"
                             Text="{Binding Editor.DepartmentName, UpdateSourceTrigger=PropertyChanged}"
                             ToolTipService.ToolTip="{DynamicResource Module.Security.Text.Department}" />

                    <TextBlock Grid.Row="6"
                               Text="{DynamicResource Module.Security.Content.Active}"
                               VerticalAlignment="Center" />
                    <CheckBox Grid.Row="6"
                              Grid.Column="1"
                              IsChecked="{Binding Editor.Active}"
                              HorizontalAlignment="Left" />

                    <TextBlock Grid.Row="7"
                               Text="{DynamicResource Module.Security.Content.Locked}"
                               VerticalAlignment="Center" />
                    <CheckBox Grid.Row="7"
                              Grid.Column="1"
                              IsChecked="{Binding Editor.IsLocked}"
                              HorizontalAlignment="Left" />

                    <TextBlock Grid.Row="8"
                               Text="{DynamicResource Module.Security.Content.TwoFactor}"
                               VerticalAlignment="Center" />
                    <CheckBox Grid.Row="8"
                              Grid.Column="1"
                              IsChecked="{Binding Editor.IsTwoFactorEnabled}"
                              HorizontalAlignment="Left" />

                    <TextBlock Grid.Row="9"
                               Text="{DynamicResource Module.Security.Text.NewPassword}"
                               VerticalAlignment="Center" />
                    <PasswordBox x:Name="NewPasswordBox"
                                 Grid.Row="9"
                                 Grid.Column="1"
                                 PasswordChar="•"
                                 PasswordChanged="OnNewPasswordChanged"
                                 ToolTipService.ToolTip="{DynamicResource Module.Security.Text.NewPassword}" />

                    <TextBlock Grid.Row="10"
                               Text="{DynamicResource Module.Security.Text.ConfirmPassword}"
                               VerticalAlignment="Center" />
                    <PasswordBox x:Name="ConfirmPasswordBox"
                                 Grid.Row="10"
                                 Grid.Column="1"
                                 PasswordChar="•"
                                 PasswordChanged="OnConfirmPasswordChanged"
                                 ToolTipService.ToolTip="{DynamicResource Module.Security.Text.ConfirmPassword}" />
                </Grid>

                <TextBlock Text="{DynamicResource Module.Security.Text.AssignedRoles}"
                           FontWeight="SemiBold"
                           Margin="0,20,0,8" />

                <ItemsControl ItemsSource="{Binding RoleOptions}"
                              Margin="0,0,0,12"
                              ItemTemplate="{StaticResource UserEditor.RoleOptionTemplate}" />

                <TextBlock Text="{DynamicResource Module.Diagnostics.Text.Session}"
                           FontWeight="SemiBold"
                           Margin="0,12,0,8" />

                <CheckBox Content="{DynamicResource Dialog.UserEdit.Toggle.Impersonation.Label}"
                          IsChecked="{Binding IsImpersonating, Mode=TwoWay}"
                          HorizontalAlignment="Left" />

                <ComboBox ItemsSource="{Binding ImpersonationTargets}"
                          DisplayMemberPath="DisplayName"
                          SelectedItem="{Binding SelectedImpersonationTarget, Mode=TwoWay}"
                          Margin="0,8,0,0"
                          ToolTipService.ToolTip="{DynamicResource Module.Diagnostics.Text.Session}" />

                <TextBox Text="{Binding ImpersonationReason, UpdateSourceTrigger=PropertyChanged}"
                         Margin="0,8,0,0"
                         ToolTipService.ToolTip="{DynamicResource Dialog.ElectronicSignature.Text.ReasonCode}" />

                <TextBox Text="{Binding ImpersonationNotes, UpdateSourceTrigger=PropertyChanged}"
                         AcceptsReturn="True"
                         TextWrapping="Wrap"
                         Height="80"
                         Margin="0,8,0,0"
                         ToolTipService.ToolTip="{DynamicResource Dialog.ElectronicSignature.Text.ReasonNote}" />

                <ItemsControl ItemsSource="{Binding ValidationMessages}"
                              Margin="0,12,0,0"
                              AutomationProperties.AutomationId="{StaticResource Dialog.UserEdit.ValidationMessages.AutomationId}"
                              ItemTemplate="{StaticResource UserEditor.ValidationMessageTemplate}" />

                <TextBlock Text="{Binding StatusMessage}"
                           Foreground="DarkRed"
                           Margin="0,8,0,0">
                    <TextBlock.Style>
                        <Style TargetType="TextBlock">
                            <Setter Property="Visibility" Value="Visible" />
                            <Style.Triggers>
                                <Trigger Property="Text" Value="">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                </Trigger>
                                <Trigger Property="Text" Value="{x:Null}">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </TextBlock.Style>
                </TextBlock>

                <ProgressBar IsIndeterminate="True"
                             Height="4"
                             Margin="0,12,0,0"
                             Visibility="{Binding IsBusy, Converter={StaticResource UserEditor.BooleanToVisibilityConverter}}" />

                <StackPanel Orientation="Horizontal"
                            HorizontalAlignment="Right"
                            Margin="0,20,0,0">
                    <Button Content="{DynamicResource Module.Toolbar.Command.Save.Content}"
                            Command="{Binding SaveCommand}"
                            ToolTipService.ToolTip="{DynamicResource Module.Toolbar.Command.Save.ToolTip}"
                            AutomationProperties.Name="{DynamicResource Module.Toolbar.Command.Save.AutomationName}"
                            AutomationProperties.AutomationId="{StaticResource Module.Toolbar.Command.Save.AutomationId}"
                            Margin="0,0,12,0"
                            IsDefault="True"
                            Width="120" />
                    <Button Content="{DynamicResource Module.Toolbar.Command.Cancel.Content}"
                            Command="{Binding CancelCommand}"
                            ToolTipService.ToolTip="{DynamicResource Module.Toolbar.Command.Cancel.ToolTip}"
                            AutomationProperties.Name="{DynamicResource Module.Toolbar.Command.Cancel.AutomationName}"
                            AutomationProperties.AutomationId="{StaticResource Module.Toolbar.Command.Cancel.AutomationId}"
                            Margin="0,0,12,0"
                            IsCancel="True"
                            Width="120" />
                    <Button Content="{DynamicResource Dialog.UserEdit.Command.BeginImpersonation.Content}"
                            Command="{Binding BeginImpersonationCommand}"
                            ToolTipService.ToolTip="{DynamicResource Dialog.UserEdit.Command.BeginImpersonation.ToolTip}"
                            AutomationProperties.Name="{DynamicResource Dialog.UserEdit.Command.BeginImpersonation.AutomationName}"
                            AutomationProperties.AutomationId="{StaticResource Dialog.UserEdit.BeginImpersonation.AutomationId}"
                            Margin="0,0,12,0"
                            Width="140" />
                    <Button Content="{DynamicResource Dialog.UserEdit.Command.EndImpersonation.Content}"
                            Command="{Binding EndImpersonationCommand}"
                            ToolTipService.ToolTip="{DynamicResource Dialog.UserEdit.Command.EndImpersonation.ToolTip}"
                            AutomationProperties.Name="{DynamicResource Dialog.UserEdit.Command.EndImpersonation.AutomationName}"
                            AutomationProperties.AutomationId="{StaticResource Dialog.UserEdit.EndImpersonation.AutomationId}"
                            Width="160" />
                </StackPanel>
            </StackPanel>
        </Border>
    </ScrollViewer>
</Window>
