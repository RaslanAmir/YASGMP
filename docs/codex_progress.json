{
  "branch": "feature/wpf-shell-full-yasgmp",
  "sdk": {
    "wpfTarget": "net9.0-windows10.0.19041.0",
    "detected": true,
    "notes": [
      "2025-10-24: Reinitialized codex_progress.json after accidental corruption; prior notes are preserved in git history.",
      "2025-10-24: Warnings batch #6 - x:DataType added to MainPage; typed LoginPage LastLogins template (x:String); MAUI warnings ~13925.",
      "2025-10-31: Fixed solution config so Debug builds include YasGMP.AppCore (added Build.0 mapping). Verified WPF + MAUI builds on .NET 9 SDK 9.0.306; smoke harness invoked with YASGMP_SMOKE=1 (inconclusive in headless session)."
    ]
  },
  "batches": [
    {
      "date": "2025-10-31",
      "type": "build-fix",
      "changes": [
        {
          "file": "yasgmp.sln",
          "action": "enable-debug-build",
          "details": "Added {YasGMP.AppCore GUID}.Debug|Any CPU.Build.0 = Debug|Any CPU"
        }
      ],
      "validation": {
        "restore": "ok",
        "build": {
          "wpf": "ok",
          "maui_win": "ok",
          "wpf_release": "ok"
        },
        "smoke": "invoked; inconclusive in non-interactive env"
      }
    }
    ,
    {
      "date": "2025-10-31",
      "type": "runtime-hardening",
      "changes": [
        { "file": "YasGMP.Wpf/Services/DockLayoutPersistenceService.cs", "action": "tolerant-double-read", "details": "Convert numeric layout fields from any numeric type to double to avoid InvalidCastException." },
        { "file": "YasGMP.AppCore/Services/AuditService.cs", "action": "api-keys-key-variants", "details": "Handle api_keys key column variants (key/api_key/value/token) in SELECT and filters." },
        { "file": "YasGMP.AppCore/Services/DatabaseService.cs", "action": "system-event-ip-fallback", "details": "Dynamic minimal INSERT without IP when system_event_log has no source_ip/ip_address/ip column; early table existence check." }
      ],
      "validation": {
        "build": { "appcore": "ok", "wpf": "ok" },
        "runtime": "DB schema differences should no longer crash; audit list tolerates missing columns"
      }
    },
    {
      "date": "2025-10-31",
      "type": "ui+db-migration",
      "changes": [
        { "file": "YasGMP.Wpf/MainWindow.xaml", "action": "avalondock-binding-fix", "details": "Use PriorityBinding for LayoutItem Title/ContentId (Model.* → LayoutElement.* → fallback) to eliminate 'Content property not found' errors and show tab titles." },
        { "file": "sql/migrations/2025-10-31_add_source_ip_session_device.sql", "action": "idempotent-columns", "details": "Add source_ip/session_id/device_info to core tables; guard against views via TABLE_TYPE='BASE TABLE'." },
        { "file": "tools/YasGMP.DbMigrator", "action": "new-tool", "details": "Console tool to run SQL with delimiter and @user variable support" }
      ],
      "validation": {
        "restore": "ok",
        "build": { "wpf": "ok", "maui_win": "ok", "tools": "ok" },
        "migration": "applied successfully to YASGMP (127.0.0.1)",
        "smoke": "headless-friendly; tests pass (18/18) with YASGMP_SMOKE=1; app auto-runs smoke at startup; log writes fall back to %TEMP% when LocalAppData is unavailable"
      }
    }
  ]
}
